<?php

/**
 * @file
 * Create one hoffiy block to enjoin the incredibad hoffify
 */

/**
 * Implements hook_help().
 */
function hoffify_help($path, $arg) {
  switch ($path) {
    case 'admin/help#hoffify':
      $output = '<h3>' . t('About') . '</h3>';
      $output .= '<p>' . t('This module provide one hoffify block') . '</p>';
      $output .= '<p>' . t('For more information visit <a href="!link">Hoffify</a>', array(
                  '!link' => url('http://www.hoffify.co.uk'))) . '</p>';
      $output .= '<h3>' . t('Usage') . '</h3>';
      $output .= '<dl>';
      $output .= '<dt>' . t('Configuration') . '</dt>';
      $output .= '<dd>' . t("No configuration needed.") . '</dd>';
      $output .= '<dt>' . t('How to use') . '</dt>';
      $output .= '<dd>' . t("You can simply add the block at your favored regions. After that click on the pictures for happiness.") . '</dd>';
      $output .= '</dl>';
      return $output;
  }
}

/**
 * Implements hook_block_info().
 *
 * This block declares which blocks are provided by the module
 */
function hoffify_block_info() {

  $block = array();
  $block['hoffify'] = array(
    'info' => t('Hoffify'),
  );

  return $block;
}

/**
 * Implements hook_block_view().
 *
 * This hook generates the contents of the blocks themselves.
 */
function hoffify_block_view() {

  $block['subject'] = t('Where there\'s Hoff, there\'s more Hoff');
  // The content of the block is typically generated by calling our custom
  // function.
  $block['content'] = hoffify_contents();

  return $block;
}

/**
 * Implementation of hook_library()
 * provide the hoffiy core javascript and extra javascript as library
 */
function hoffify_library() {
  $libraries = array();
  // hoffify core script
  $libraries['hoffify'] = array(
      'title' => 'Hoffify',
      'website' => 'http://www.hoffify.co.uk/',
      'version' => '1.0',
      'js' => array(
          drupal_get_path('module', 'hoffify') . '/js/hoffify.js' => array(),
      ),
  );
  // hoffify images
  $libraries['hoffify_images'] = array(
    'title' => 'Hoffify',
    'website' => 'http://www.hoffify.co.uk/',
    'version' => '1.0',
    'js' => array(
        drupal_get_path('module', 'hoffify') . '/js/hoff_data.json' => array(),
    ),
  );

return $libraries;
}

/**
 * Add hoffify JavaScript element to the page.
 */
function hoffify_add() {
  drupal_add_library('hoffify', 'hoffify');
  drupal_add_library('hoffify', 'hoffify_images');
}

/**
 * A module-defined block content function.
 */
function hoffify_contents() {
  // add hoffify script.
  hoffify_add();
  // return html
  $content = ('
    <a href="#" onclick="hoffify_add();return false;">
    <img src="http://hoffify.co.uk/images/hoffify.png" alt="Hoffify">
    </a>
  ');

  return $content;
}
